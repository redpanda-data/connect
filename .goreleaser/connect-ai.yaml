---
project_name: redpanda-connect
dist: target/dist
version: 2

builds:
  - id: connect-ai
    main: cmd/redpanda-connect-ai/main.go
    binary: redpanda-connect
    goos: [ linux ]
    goarch: [ amd64, arm64 ]
    env:
      - CGO_ENABLED=0
    tags:
      - timetzdata
    ldflags: >
      -s -w
      -X main.Version={{.Version}}
      -X main.DateBuilt={{.Date}}
      -X main.BinaryName=redpanda-connect-ai

dockers_v2:
  - id: connect-ai
    dockerfile: resources/docker/ai.Dockerfile
    ids:
      - connect-ai
    images:
      - redpandadata/connect
      - public.ecr.aws/l9j0i2e0/connect
    tags:
      - "{{ if not .IsSnapshot }}{{ .Version }}-ai{{ end }}"
      - "{{ if not .IsSnapshot }}{{ .Major }}.{{.Minor}}-ai{{ end }}"
      - "{{ if not .IsSnapshot }}{{ .Major }}-ai{{ end }}"
      - "{{ if not .IsSnapshot }}latest-ai{{ end }}"
      - "{{ if .IsSnapshot }}edge-ai{{ end }}"
    platforms:
      - linux/amd64
      - linux/arm64
    extra_files:
      - config/docker.yaml

