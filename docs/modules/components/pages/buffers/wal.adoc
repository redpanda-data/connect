= wal
:type: buffer
:status: experimental



////
     THIS FILE IS AUTOGENERATED!

     To make changes, edit the corresponding source file under:

     https://github.com/redpanda-data/connect/tree/main/internal/impl/<provider>.

     And:

     https://github.com/redpanda-data/connect/tree/main/cmd/tools/docs_gen/templates/plugin.adoc.tmpl
////

// Â© 2024 Redpanda Data Inc.


component_type_dropdown::[]


A write ahead log (WAL) buffer that keeps writes in memory but also persists batches to disk.

```yml
# Config fields, showing default values
buffer:
  wal:
    path: "" # No default (required)
    limits:
      count: 0
    max_segment_size: 20MiB
    max_segment_age: 1d
    shards: 1
```

A write ahead log (WAL) buffer that keeps writes in memory but also persists batches to disk.
Messages are not acknowledge from the input until they have been safely written to disk.

Each batch is written to a segment file, which is a chunk of the WAL. When a segment file is full based on the 'max_segment_age' and 'max_segment_size'
configuration, a new segment file is created. The old segment file will be deleted when all the messages within it have been acknowledged, which preserves
at least once message processing.

Upon startup, writes are not accepted from the 'input', and all the segment files are read to reply any leftover messages from the previous process. Note that
because WAL cleanup happens at the segment level, this means that if a single message is not acknowledged within a segment file, all messages in the segment file
will be replayed upon startup.


== Fields

=== `path`

The directory in which WAL files are saved.


*Type*: `string`


=== `limits`

Limits that bound the amount of memory used by the buffer. When a limit is hit, backpressure is applied to the input.


*Type*: `object`


=== `limits.count`

The maximum number of messages inflight at once from the buffer. If the limit is 0 then there is no maximum on the number of messages.


*Type*: `int`

*Default*: `0`

=== `max_segment_size`

The maximum size that a single segment of the WAL will grow before being rotated.


*Type*: `string`

*Default*: `"20MiB"`

```yml
# Examples

max_segment_size: 50MB

max_segment_size: 1GB
```

=== `max_segment_age`

The maximum age of a single segment of the WAL will be before being rotated.


*Type*: `string`

*Default*: `"1d"`

```yml
# Examples

max_segment_age: 1h

max_segment_age: 7d
```

=== `shards`

The number of shards or seperate WAL files there are. When there is only a single shard messages are processed in order. Setting this to greater than 1 will support multiple log files, which can improve performance, but messages can be processed out of order.


*Type*: `int`

*Default*: `1`


