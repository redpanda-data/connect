= cohere_rerank
:type: processor
:status: experimental
:categories: ["AI"]



////
     THIS FILE IS AUTOGENERATED!

     To make changes, edit the corresponding source file under:

     https://github.com/redpanda-data/connect/tree/main/internal/impl/<provider>.

     And:

     https://github.com/redpanda-data/connect/tree/main/cmd/tools/docs_gen/templates/plugin.adoc.tmpl
////

// Â© 2024 Redpanda Data Inc.


component_type_dropdown::[]


Generates vector embeddings to represent input text, using the Cohere API.

Introduced in version 4.37.0.

```yml
# Config fields, showing default values
label: ""
cohere_rerank:
  base_url: https://api.cohere.com
  api_key: "" # No default (required)
  model: rerank-v3.5 # No default (required)
  query: "" # No default (required)
  documents: "" # No default (required)
  top_n: 0
  max_tokens_per_doc: 4096
```

This processor sends document strings to the Cohere API, which reranks them based on the relevance to the query.

To learn more about reranking, see the https://docs.cohere.com/docs/rerank-2[Cohere API documentation^].

The output of this processor is an array of strings that are ordered by their relevance.

== Metadata

relevance_scores: an array of scores for each document, indicating how relevant it is to the query. The scores are in the same order as the documents in the input. The higher the score, the more relevant the document is to the query.

		

== Examples

[tabs]
======
Rerank some documents based on a query::
+
--

Rerank some documents based on a query

```yamlinput:
  generate:
    interval: 1s
    mapping: |
      root = {
        "query": fake("sentence"),
        "docs": [fake("paragraph"), fake("paragraph"), fake("paragraph")],
      }
pipeline:
  processors:
  - cohere_rerank:
      model: rerank-v3.5
      api_key: "${COHERE_API_KEY}"
      query: "${!this.query}"
      documents: "root = this.docs"
output:
  stdout: {}```

--
======

== Fields

=== `base_url`

The base URL to use for API requests.


*Type*: `string`

*Default*: `"https://api.cohere.com"`

=== `api_key`

The API key for the Cohere API.
[CAUTION]
====
This field contains sensitive information that usually shouldn't be added to a config directly, read our xref:configuration:secrets.adoc[secrets page for more info].
====



*Type*: `string`


=== `model`

The name of the Cohere model to use.


*Type*: `string`


```yml
# Examples

model: rerank-v3.5
```

=== `query`

The search query
This field supports xref:configuration:interpolation.adoc#bloblang-queries[interpolation functions].


*Type*: `string`


=== `documents`

A list of texts that will be compared to the query. For optimal performance Cohere recommends against sending more than 1000 documents in a single request. NOTE: structured data should be formatted as YAML for best performance.


*Type*: `string`


=== `top_n`

The number of documents to return, if 0 all documents are returned.


*Type*: `int`

*Default*: `0`

=== `max_tokens_per_doc`

Long documents will be automatically truncated to the specified number of tokens.


*Type*: `int`

*Default*: `4096`


