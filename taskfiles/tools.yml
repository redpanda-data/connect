version: '3'

vars:
  GOBIN:
    sh: realpath {{.TOOLS_BIN_DIR}}

tasks:
  install-all:
    deps:
      - install-golangci-lint
      - install-govulncheck

  install-golangci-lint:
    desc: Install golangci-lint
    required:
      vars:
        - TOOLS_BIN_DIR
        - GOLANGCI_LINT_VERSION
    silent: true
    sources:
      - .versions
    cmds:
      - GOBIN={{.TOOLS_BIN_DIR}} go install github.com/golangci/golangci-lint/v2/cmd/golangci-lint@v{{.GOLANGCI_LINT_VERSION}}

  install-govulncheck:
    desc: Install govulncheck
    required:
      vars:
        - TOOLS_BIN_DIR
    run: always
    silent: true
    cmds:
      - GOBIN={{.TOOLS_BIN_DIR}} go install golang.org/x/vuln/cmd/govulncheck@latest
